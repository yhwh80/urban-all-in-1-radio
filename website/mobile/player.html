<!DOCTYPE html>
<html class="dark" lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0, viewport-fit=cover, maximum-scale=1.0, user-scalable=no"
        name="viewport" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Urban All-in-1 Radio - Live</title>
    <meta name="description" content="Urban All-in-1 Radio â€” UK's home for Hip-Hop, R&B, Afrobeats, Dancehall & Drill. Live 24/7. Global Beats, Local Vibes.">

    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="../images/favicon-32.png">
    <link rel="apple-touch-icon" sizes="180x180" href="../images/apple-touch-icon.png">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://urbanallin1radio.co.uk/">
    <meta property="og:title" content="Urban All-in-1 Radio | Live Now">
    <meta property="og:description" content="UK's home for Hip-Hop, R&B, Afrobeats, Dancehall & Drill. Live 24/7. Global Beats, Local Vibes.">
    <meta property="og:image" content="https://urbanallin1radio.co.uk/images/og-preview.png">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://urbanallin1radio.co.uk/">
    <meta name="twitter:title" content="Urban All-in-1 Radio | Live Now">
    <meta name="twitter:description" content="UK's home for Hip-Hop, R&B, Afrobeats, Dancehall & Drill. Live 24/7. Global Beats, Local Vibes.">
    <meta name="twitter:image" content="https://urbanallin1radio.co.uk/images/og-preview.png">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <link href="https://fonts.googleapis.com/css2?family=Spline+Sans:wght@300;400;500;600;700&display=swap"
        rel="stylesheet" />
    <!-- Material Symbols -->
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap"
        rel="stylesheet" />
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#00f5ff",
                        "accent": "#ff00ff",
                        "background-dark": "#0a0a0f",
                        "surface-dark": "#12121a",
                    },
                    fontFamily: {
                        "display": ["Spline Sans", "sans-serif"]
                    },
                },
            },
        }
    </script>
    <style>
        body {
            min-height: 100dvh;
            touch-action: manipulation;
        }

        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        @keyframes pulse-bar {

            0%,
            100% {
                height: 30%;
            }

            50% {
                height: 100%;
            }
        }

        .visualizer-bar {
            animation: pulse-bar 0.8s ease-in-out infinite;
        }

        .visualizer-bar:nth-child(2) {
            animation-delay: 0.1s;
        }

        .visualizer-bar:nth-child(3) {
            animation-delay: 0.2s;
        }

        .visualizer-bar:nth-child(4) {
            animation-delay: 0.3s;
        }

        .visualizer-bar:nth-child(5) {
            animation-delay: 0.15s;
        }

        /* Idle visualizer animation - subtle breathing */
        @keyframes idle-bar {
            0%, 100% { height: 15%; opacity: 0.3; }
            50% { height: 25%; opacity: 0.5; }
        }

        .visualizer-idle .visualizer-bar {
            animation: idle-bar 2s ease-in-out infinite;
        }
        .visualizer-idle .visualizer-bar:nth-child(2) { animation-delay: 0.3s; }
        .visualizer-idle .visualizer-bar:nth-child(3) { animation-delay: 0.6s; }
        .visualizer-idle .visualizer-bar:nth-child(4) { animation-delay: 0.9s; }
        .visualizer-idle .visualizer-bar:nth-child(5) { animation-delay: 0.4s; }

        /* Scrolling marquee for long text - smooth seamless loop */
        .marquee-container {
            overflow: hidden;
            white-space: nowrap;
            position: relative;
            mask-image: linear-gradient(to right, transparent, black 8%, black 92%, transparent);
            -webkit-mask-image: linear-gradient(to right, transparent, black 8%, black 92%, transparent);
        }

        .marquee-content {
            display: inline-block;
            min-width: 100%;
        }

        .marquee-track {
            display: flex;
            width: max-content;
            animation: marquee-scroll var(--duration, 12s) linear infinite;
        }

        .marquee-item {
            flex-shrink: 0;
            padding-right: 5rem;
        }

        @keyframes marquee-scroll {
            0% { transform: translateX(0); }
            100% { transform: translateX(calc(-50% - 0.5px)); }
        }
    </style>
</head>

<body class="font-display bg-background-dark text-white antialiased">
    <div class="relative flex min-h-screen w-full flex-col pb-24">
        <!-- Background Gradient -->
        <div class="absolute inset-0 z-0">
            <div class="absolute top-[-20%] left-[-20%] w-[60%] h-[40%] bg-primary/20 rounded-full blur-[100px]"></div>
            <div class="absolute bottom-[-20%] right-[-20%] w-[70%] h-[50%] bg-blue-600/10 rounded-full blur-[100px]">
            </div>
        </div>

        <!-- Header -->
        <header class="flex items-center justify-between p-4 pt-12 z-10 relative">
            <a href="../index.html"
                class="flex items-center justify-center text-white/70 hover:text-white size-10 rounded-full active:bg-white/10">
                <span class="material-symbols-outlined text-2xl">keyboard_arrow_left</span>
            </a>
            <div class="flex flex-col items-center">
                <div class="flex items-center gap-2">
                    <span id="liveIndicator" class="w-2 h-2 rounded-full bg-primary animate-pulse"></span>
                    <span class="text-xs font-bold tracking-widest uppercase text-primary">Live Broadcast</span>
                </div>
                <h2 class="text-base font-bold leading-tight mt-0.5">Urban Radio</h2>
            </div>
            <button
                class="flex items-center justify-center text-white/70 hover:text-white size-10 rounded-full active:bg-white/10">
                <span class="material-symbols-outlined">more_horiz</span>
            </button>
        </header>

        <!-- Main Content -->
        <main class="flex-1 flex flex-col justify-center items-center px-6 z-10 relative">
            <!-- Visualizer - starts with idle animation -->
            <div id="visualizer" class="flex items-center justify-center gap-1.5 h-24 mb-8 visualizer-idle">
                <div class="w-1.5 bg-primary rounded-full visualizer-bar" style="height: 20%;"></div>
                <div class="w-1.5 bg-primary rounded-full visualizer-bar" style="height: 35%;"></div>
                <div class="w-1.5 bg-primary rounded-full visualizer-bar" style="height: 50%;"></div>
                <div class="w-1.5 bg-primary rounded-full visualizer-bar" style="height: 30%;"></div>
                <div class="w-1.5 bg-primary rounded-full visualizer-bar" style="height: 15%;"></div>
            </div>

            <!-- Genre Badge -->
            <div class="mb-4">
                <span id="genreBadge"
                    class="inline-flex items-center px-3 py-1 rounded-full text-xs font-bold tracking-wider uppercase bg-primary/20 text-primary border border-primary/30">
                    LOADING...
                </span>
            </div>

            <!-- Track Info with scrolling marquee for long names -->
            <div class="text-center mb-4 w-full px-4">
                <div id="titleContainer" class="marquee-container">
                    <h1 id="trackTitle" class="text-2xl font-bold leading-tight marquee-content">CONNECTING...</h1>
                </div>
                <div id="artistContainer" class="marquee-container mt-1">
                    <p id="trackArtist" class="text-primary text-lg font-medium marquee-content">WAITING FOR DATA</p>
                </div>
            </div>

            <!-- Progress Bar -->
            <div class="w-full max-w-xs px-4 mb-8">
                <div class="flex justify-between text-xs text-white/50 mb-1">
                    <span id="elapsedTime">0:00</span>
                    <span id="remainingTime">-0:00</span>
                </div>
                <div class="w-full h-1 bg-white/10 rounded-full overflow-hidden">
                    <div id="progressBar"
                        class="h-full bg-gradient-to-r from-primary to-accent rounded-full transition-all duration-1000"
                        style="width: 0%;"></div>
                </div>
            </div>

            <!-- Play Button -->
            <div class="relative mb-12">
                <div class="absolute -inset-2 bg-primary rounded-full blur opacity-30"></div>
                <button id="playBtn"
                    class="relative flex items-center justify-center size-24 rounded-full bg-primary text-white shadow-2xl shadow-primary/40 active:scale-95 transition-transform">
                    <span id="playIcon" class="material-symbols-outlined text-5xl"
                        style="font-variation-settings: 'FILL' 1;">play_arrow</span>
                </button>
            </div>

            <!-- Volume Control -->
            <div class="flex items-center gap-4 w-full max-w-xs px-4">
                <span class="material-symbols-outlined text-white/50 text-xl">volume_down</span>
                <input id="volumeSlider" type="range" min="0" max="100" value="70"
                    class="flex-1 h-1 bg-white/20 rounded-full appearance-none cursor-pointer
                    [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-4 [&::-webkit-slider-thumb]:h-4 
                    [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-white [&::-webkit-slider-thumb]:shadow-lg">
                <span class="material-symbols-outlined text-white text-xl">volume_up</span>
            </div>
        </main>

    </div>

    <!-- Bottom Nav (Fixed) -->
    <nav
        class="fixed bottom-0 left-0 right-0 flex justify-around items-center p-4 pb-8 z-50 border-t border-white/5 bg-background-dark/95 backdrop-blur-lg">
        <button class="flex flex-col items-center gap-1 text-primary">
            <span class="material-symbols-outlined text-2xl" style="font-variation-settings: 'FILL' 1;">radio</span>
            <span class="text-[10px] font-medium">Live</span>
        </button>
        <a href="schedule.html" class="flex flex-col items-center gap-1 text-white/50 active:text-primary">
            <span class="material-symbols-outlined text-2xl">calendar_month</span>
            <span class="text-[10px] font-medium">Schedule</span>
        </a>
        <a href="news.html" class="flex flex-col items-center gap-1 text-white/50 active:text-primary">
            <span class="material-symbols-outlined text-2xl">newspaper</span>
            <span class="text-[10px] font-medium">News</span>
        </a>
        <a href="discover.html" class="flex flex-col items-center gap-1 text-white/50 active:text-primary">
            <span class="material-symbols-outlined text-2xl">explore</span>
            <span class="text-[10px] font-medium">Discover</span>
        </a>
    </nav>

    <!-- Audio Element -->
    <audio id="radioStream" preload="none"></audio>

	    <script>
	        // Configuration
	        const CONFIG = {
	            streamUrl: 'https://stream.urbanallin1radio.co.uk/radio.mp3',
	            nowPlayingUrl: 'https://a7.asurahosting.com/api/nowplaying/urban_-_all_in_1_radio',
	            updateInterval: 5000
	        };

        // Elements
        const radioStream = document.getElementById('radioStream');
        const playBtn = document.getElementById('playBtn');
        const playIcon = document.getElementById('playIcon');
        const trackTitle = document.getElementById('trackTitle');
        const trackArtist = document.getElementById('trackArtist');
        const volumeSlider = document.getElementById('volumeSlider');
        const visualizer = document.getElementById('visualizer');
        const liveIndicator = document.getElementById('liveIndicator');
        const genreBadge = document.getElementById('genreBadge');
        const progressBar = document.getElementById('progressBar');
        const elapsedTime = document.getElementById('elapsedTime');
        const remainingTime = document.getElementById('remainingTime');

        let isPlaying = false;
        let currentTrackData = null;

        // Initialize
        radioStream.src = CONFIG.streamUrl;

        // Restore volume from localStorage or default to 0.7
        const savedVolume = localStorage.getItem('urbanRadioVolume');
        radioStream.volume = savedVolume ? parseFloat(savedVolume) : 0.7;
        volumeSlider.value = radioStream.volume * 100;

        // Format seconds to M:SS
        function formatTime(seconds) {
            if (!seconds || seconds < 0) return '0:00';
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        // Update progress bar
        function updateProgress() {
            if (!currentTrackData) return;
            const { played_at, duration } = currentTrackData;
            const now = Math.floor(Date.now() / 1000);
            const elapsed = now - played_at;
            const remaining = Math.max(0, duration - elapsed);
            const percent = Math.min(100, (elapsed / duration) * 100);

            progressBar.style.width = `${percent}%`;
            elapsedTime.textContent = formatTime(elapsed);
            remainingTime.textContent = `-${formatTime(remaining)}`;
        }

        // Play/Pause
        function togglePlay() {
            if (isPlaying) {
                radioStream.pause();
                playIcon.textContent = 'play_arrow';
                // Switch to idle animation instead of static
                visualizer.classList.add('visualizer-idle');
                visualizer.style.opacity = '1';
                liveIndicator.classList.remove('animate-pulse');
                liveIndicator.classList.add('bg-gray-500');
                liveIndicator.classList.remove('bg-primary');
                localStorage.setItem('urbanRadioPlaying', 'false');
            } else {
                radioStream.play().catch(e => console.error(e));
                playIcon.textContent = 'pause';
                // Switch to active animation
                visualizer.classList.remove('visualizer-idle');
                visualizer.style.opacity = '1';
                liveIndicator.classList.add('animate-pulse');
                liveIndicator.classList.remove('bg-gray-500');
                liveIndicator.classList.add('bg-primary');
                localStorage.setItem('urbanRadioPlaying', 'true');
            }
            isPlaying = !isPlaying;
        }

        playBtn.addEventListener('click', togglePlay);

        // Volume
        volumeSlider.addEventListener('input', (e) => {
            radioStream.volume = e.target.value / 100;
            localStorage.setItem('urbanRadioVolume', radioStream.volume);
        });

        // Always start paused - user must press play
        // (removed auto-resume to avoid confusion)

        // Check if text needs marquee scrolling - smooth seamless version
        function setupMarquee(element, container, text) {
            // Reset to plain text first
            element.innerHTML = text;
            element.classList.remove('marquee-content');

            // Wait for layout to calculate widths
            requestAnimationFrame(() => {
                requestAnimationFrame(() => {
                    const containerWidth = container.offsetWidth;
                    const textWidth = element.scrollWidth;

                    if (textWidth > containerWidth) {
                        // Text is too long - create seamless scrolling track
                        const speed = Math.max(10, textWidth / 25); // Slower for readability
                        element.classList.add('marquee-content');
                        element.innerHTML = `
                            <div class="marquee-track" style="--duration: ${speed}s">
                                <div class="marquee-item">${text}</div>
                                <div class="marquee-item">${text}</div>
                            </div>
                        `;
                    } else {
                        // Text fits - just show it centered
                        element.innerHTML = text;
                        element.classList.remove('marquee-content');
                    }
                });
            });
        }

        // Now Playing
        async function fetchNowPlaying() {
            try {
                const response = await fetch(CONFIG.nowPlayingUrl);
                const data = await response.json();
                if (data && data.now_playing && data.now_playing.song) {
                    const np = data.now_playing;
                    const title = np.song.title || 'Unknown Track';
                    const artist = np.song.artist || 'Unknown Artist';

                    // Setup marquee for long text
                    const titleContainer = document.getElementById('titleContainer');
                    const artistContainer = document.getElementById('artistContainer');
                    setupMarquee(trackTitle, titleContainer, title);
                    setupMarquee(trackArtist, artistContainer, artist);

                    // Genre/Playlist badge
                    const genre = np.playlist || np.song.genre || 'LIVE';
                    genreBadge.textContent = genre.toUpperCase();

                    // Store for progress updates
                    currentTrackData = {
                        played_at: np.played_at,
                        duration: np.duration
                    };
                    updateProgress();
                }
            } catch (e) {
                console.error('Error fetching now playing:', e);
                genreBadge.textContent = 'OFFLINE';
            }
        }

        fetchNowPlaying();
        setInterval(fetchNowPlaying, CONFIG.updateInterval);
        // Update progress every second for smooth bar
        setInterval(updateProgress, 1000);
    </script>
</body>

</html>